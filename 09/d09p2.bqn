#! /usr/bin/env -S bqn -f

# m - map format, rle blocks
# b - blocks, individual
# f - file
# o - occupied
# a - available

Load â† -âŸœ'0' Â¯1âŠ¸â†“âˆ˜â€¢FBytes
Solve â† { ğ•Š map:
  momask â† (â‰ map)â¥Š1â€¿0
  mbid â† +` Â»map
  asize â† (Â¬momask) Ã— map
  fsize â† momask / map
  ChecksumMove â† { fi ğ•Š cs:
     sz â† fi âŠ‘ fsize
     asize szâŒ¾((2Ã—fi)âŠ¸âŠ‘)â†©
     ai â† âŠ‘âˆ˜âŠâŸœ1 asizeâ‰¥ sz
     fb â† aiâŠ‘mbid
     asize (-âŸœsz)âŒ¾(aiâŠ¸âŠ‘)â†©
     mbid (+âŸœsz)âŒ¾(aiâŠ¸âŠ‘)â†©
     cs+ fiÃ— +Â´ fb+ â†•sz
  }

  0 ChecksumMoveÂ´ â†•â‰ fsize
}

â€¢Showâˆ˜Solveâˆ˜LoadÂ¨ â€¢args

