#! /usr/bin/env -S bqn -f

# m - map format, rle blocks
# b - blocks, individual
# f - file
# o - occupied
# a - available

Load â† -âŸœ'0' Â¯1âŠ¸â†“âˆ˜â€¢FBytes
Solve â† { ğ•Š map:
  momask â† Â¬2|â†•â‰ map
  mbid â† +` Â»map
  asize â† (Â¬momask) Ã— map
  fsize â† momask / map
  ChecksumMove â† { fi ğ•Š cs:
     sz â† fi âŠ‘ fsize
     asize â†© szâŒ¾((2Ã—fi)âŠ¸âŠ‘) asize
     ai â† âŠ‘âˆ˜âŠâŸœâŸ¨1âŸ© asizeâ‰¥ sz
     fb â† aiâŠ‘mbid
     asize â†© (-âŸœsz)âŒ¾(aiâŠ¸âŠ‘) asize
     mbid â†© (+âŸœsz)âŒ¾(aiâŠ¸âŠ‘) mbid
     cs+ fiÃ— +Â´ fb+ â†•sz
  }

  0 ChecksumMoveÂ´ â†•â‰ fsize
}

â€¢Showâˆ˜Solveâˆ˜LoadÂ¨ â€¢args
