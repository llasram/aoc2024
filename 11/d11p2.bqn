#! /usr/bin/env -S bqn -f

ToNats â† { ((>âŸœÂ«0âŠ¸â‰¤) / 0(0âŠ¸â‰¤Ã—Ã—âŸœ10âŠ¸+)`âŠ¢) 10âŠ¸â‰¤âŠ¸(Â¬âŠ¸Ã—-âŠ£) ğ•©-'0' }

Load â† ToNats â€¢FChars
NDigits â† âŒŠ1+10â‹†â¼âŠ¢
Blink â† {
  ğ•Š 0: âŸ¨1âŸ© ;
  ğ•Š n: d â† NDigits n â‹„ {
    Â¬2|d ? (10â‹†dâŒŠâˆ˜Ã·2) (âŒŠâˆ˜Ã·Ëœâ‹ˆ|) n ;
    âŸ¨2024 Ã— nâŸ©
  }
}

SolveGeneric â† { t ğ•Š stones:
  memo â† âŸ¨âŸ© â€¢HashMap âŸ¨âŸ©
  StoneCount â† {
    ğ•Š 1â€¿0: 1 ;
    ğ•Š 1â€¿n: 2 - 2| NDigits n ;
    ğ•Š ğ•©: memo.Has ğ•© ? memo.Get ğ•© ;
    ğ•Š iâ€¿n: ğ•© memo.Set c â† +Â´ (i-1) ğ•Šâˆ˜â‹ˆÂ¨ Blink n â‹„ c
  }
  +Â´ t StoneCountâˆ˜â‹ˆÂ¨ stones
}

Solve â† 75âŠ¸SolveGeneric

â€¢Showâˆ˜Solveâˆ˜LoadÂ¨ â€¢args
