#! /usr/bin/env -S bqn -f

ToNats â† { ((>âŸœÂ«0âŠ¸â‰¤) / 0(0âŠ¸â‰¤Ã—Ã—âŸœ10âŠ¸+)`âŠ¢) 10âŠ¸â‰¤âŠ¸(Â¬âŠ¸Ã—-âŠ£) ğ•©-'0' }

Load â† ToNats â€¢FChars
NDigits â† âŒŠ1+10â‹†â¼âŠ¢
Blink â† {
  ğ•Š 0: âŸ¨1âŸ© ;
  ğ•Š n: d â† 1+âŒŠ10â‹†â¼ n â‹„ {
    Â¬2|d ? (10â‹†dâŒŠâˆ˜Ã·2) (âŒŠâˆ˜Ã·Ëœâ‹ˆ|) n ;
    âŸ¨2024 Ã— nâŸ©
  }
}

SolveGeneric â† { t ğ•Š stones:
  total â† 0
  stack â† t â‹ˆ Â¨stones
  StepItem â† {
    ğ•Š 1â€¿0: total +â†© 1 â‹„ @ ;
    ğ•Š 1â€¿n: total +â†© 2 - 2| NDigits n â‹„ @ ;
    ğ•Š iâ€¿n: stack âˆ¾â†© (i-1) â‹ˆÂ¨ Blink n â‹„ @
  }
  Step â† { ğ•Š: tos â† Â¯1âŠ‘stack â‹„ stack Â¯1âŠ¸â†“â†© â‹„ StepItem tos â‹„ @ }
  NotDone â† { ğ•Š: 0â‰ â‰ stack }
  Step â€¢_while_ NotDone @
  total
}

Solve â† 75âŠ¸SolveGeneric

â€¢Showâˆ˜Solveâˆ˜LoadÂ¨ â€¢args
