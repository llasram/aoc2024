#! /usr/bin/env -S bqn -f

ToNats â† { ((>âŸœÂ«0âŠ¸â‰¤) / 0(0âŠ¸â‰¤Ã—Ã—âŸœ10âŠ¸+)`âŠ¢) 10âŠ¸â‰¤âŠ¸(Â¬âŠ¸Ã—-âŠ£) ğ•©-'0' }
SplitM â† (Â¬-Ëœ âŠ¢Ã— Â·+`Â»âŠ¸>)âŠ¸âŠ”
Load â† { âˆ¾Â¨ âŸ¨âŸ©âŠ¸â‰¢Â¨âŠ¸SplitM ToNatsÂ¨ â€¢FLines ğ•© }

Solve â† { ğ•Š âŸ¨aâ€¿bâ€¿c, programâŸ©:
  ip â† Â¯1 â‹„ output â† âŸ¨âŸ©

  Read â† {ğ•¤â‹„ (ip+â†©1) âŠ‘ program}
  LiteralOperand â† Read
  ComboOperand â† {
    ğ•Š 0: 0; ğ•Š 1: 1; ğ•Š 2: 2; ğ•Š 3: 3;
    ğ•Š 4: a; ğ•Š 5: b; ğ•Š 6: c; ! "invalid combo operand"
  }âˆ˜Read
  ExecuteInstruction â† {
    ğ•Š 0: a (a âŒŠâˆ˜Ã· 2â‹†ComboOperand)â†© ;
    ğ•Š 1: b (âŠ‘ â‹ˆ 32â€¢bit._xor â‹ˆâˆ˜LiteralOperand)â†© ;
    ğ•Š 2: b (8|ComboOperand)â†© ;
    ğ•Š 3: ip1 â† (aâ‰ 0)â—¶âŸ¨{ğ•¤â‹„ip}, -âŸœ1âŸ© LiteralOperand@ â‹„ ipâ†©ip1 ;
    ğ•Š 4: b (âŠ‘ â‹ˆ 32â€¢bit._xor â‹ˆâˆ˜câˆ˜Read)â†© ;
    ğ•Š 5: output âˆ¾âŸœ(8|ComboOperand)â†© ;
    ğ•Š 6: b (a âŒŠâˆ˜Ã· 2â‹†ComboOperand)â†© ;
    ğ•Š 7: c (a âŒŠâˆ˜Ã· 2â‹†ComboOperand)â†©
  }âˆ˜Read
  Terminated â† {ğ•¤â‹„ ip â‰¥ Â¯1+â‰ program}

  (ExecuteInstruction)â€¢_while_(Â¬Terminated) @

  output
}

Display â† â€¢Out Â¯1â†“ ""{(â€¢Fmt ğ•¨)âˆ¾","âˆ¾ğ•©}Â´âŠ¢

Displayâˆ˜Solveâˆ˜LoadÂ¨ â€¢args
