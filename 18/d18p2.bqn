#! /usr/bin/env -S bqn -f

_FP â† { F _ğ•£ x: {F xâ†©ğ•©}â€¢_while_{xâ‰¢ğ•©} F x ; ğ•¨âŠ¸ğ”½ _ğ•£ ğ•©  }

ToNats â† { ((>âŸœÂ«0âŠ¸â‰¤) / 0(0âŠ¸â‰¤Ã—Ã—âŸœ10âŠ¸+)`âŠ¢) 10âŠ¸â‰¤âŠ¸(Â¬âŠ¸Ã—-âŠ£) ğ•©-'0' }
Load â† { > ToNatsÂ¨ â€¢FLines ğ•© }

moves â† âŸ¨Â», Â»Ë˜, Â«, Â«Ë˜âŸ©
Solve â† { ğ•Š bytes:
  spos â† âŸ¨1, 1âŸ© â‹„ epos â† 1+âŒˆËbytes â‹„ dim â† 2+epos
  mask â† {âŠ‘â—¶âˆâ€¿0}â‰0 âˆ§Â´ moves {ğ•ğ•©}Â¨ <dimâ¥Š1
  cost0 â† 0âŒ¾(sposâŠ¸âŠ‘) dimâ¥Šâˆ
  Step â† { ğ•Š cost: costâŒŠ âŒŠÂ´ moves {mask+ğ•ğ•©}Â¨ <1+cost }
  MetaStep â† {
    Â· ğ•Š Â·â€¿1: ğ•© ;
    b ğ•Š Â·â€¿0: mask âˆâŒ¾((1+b)âŠ¸âŠ‘)â†© â‹„ {
      âˆ â‰¡ epos âŠ‘ Step _FP cost0 ? bâ€¿1 ;
      bâ€¿0
    }
  }
  âŠ‘ âŸ¨0â€¿0, 0âŸ© MetaStepË âŒ½bytes
}

Display â† { ğ•Š xâ€¿y: â€¢Out x {ğ•¨âˆ¾","âˆ¾ğ•©}â—‹â€¢Fmt y }

Displayâˆ˜Solveâˆ˜LoadÂ¨ â€¢args
