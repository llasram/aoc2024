#! /usr/bin/env -S bqn -f

_FP â† { F _ğ•£ x: {F xâ†©ğ•©}â€¢_while_{xâ‰¢ğ•©} F x ; ğ•¨âŠ¸ğ”½ _ğ•£ ğ•©  }

ToNats â† { ((>âŸœÂ«0âŠ¸â‰¤) / 0(0âŠ¸â‰¤Ã—Ã—âŸœ10âŠ¸+)`âŠ¢) 10âŠ¸â‰¤âŠ¸(Â¬âŠ¸Ã—-âŠ£) ğ•©-'0' }
Load â† { > ToNatsÂ¨ â€¢FLines ğ•© }

moves â† âŸ¨Â», Â»Ë˜, Â«, Â«Ë˜âŸ©
Solve â† { ğ•Š bytes:
  spos â† âŸ¨1, 1âŸ© â‹„ epos â† 1+âŒˆËbytes â‹„ dim â† 2+epos
  mask0 â† âˆ§Â´ moves {ğ•ğ•©}Â¨ <dimâ¥Š1
  visit0 â† 1âŒ¾(sposâŠ¸âŠ‘) dimâ¥Š0

  CanTraverse â† { ğ•Š mask: eposâŠ‘ {ğ•©âˆ¨ âˆ¨Â´moves{maskÃ—ğ•ğ•©}Â¨<ğ•©}_FP visit0 }
  BinarySearch â† {
    Â· ğ•Š [b]: b ;
    mask0 R bytes: {
      n â† 2âŒŠâˆ˜Ã·Ëœâ‰ bytes
      mask1 â† mask0 {0âŒ¾(ğ•¨âŠ¸âŠ‘) ğ•©}Ë nâ†‘bytes
      CanTraverseâ—¶âŸ¨
        {ğ•¤â‹„ mask0 R nâ†‘bytes}
        {ğ•¤â‹„ mask1 R nâ†“bytes}
      âŸ© mask1
    }
  }

  Â¯1+ mask0 BinarySearch 1+bytes
}

Display â† { ğ•Š xâ€¿y: â€¢Out x {ğ•¨âˆ¾","âˆ¾ğ•©}â—‹â€¢Fmt y }

Displayâˆ˜Solveâˆ˜LoadÂ¨ â€¢args
